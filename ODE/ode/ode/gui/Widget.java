//*************************************************************************************************
package ode.gui;
//*************************************************************************************************

import java.util.Collections;
import java.util.EnumSet;
import java.util.List;
import java.util.Set;

import javax.vecmath.Color4f;
import javax.vecmath.Vector2f;

import ode.util.Node;

//*************************************************************************************************
public class Widget extends Node<Widget> {

	//=============================================================================================
	private GUI    gui;
	private String name;
	//=============================================================================================

	//=============================================================================================
	private final Set<Flag> flags    = EnumSet.noneOf(Flag.class);
	private final Set<Flag> flags_ro = Collections.unmodifiableSet(flags);
	//=============================================================================================

	//=============================================================================================
	private final Vector2f position  = new Vector2f();
	private final Vector2f dimension = new Vector2f();
	//=============================================================================================

	//=============================================================================================
	private final Color4f foreground = new Color4f(0, 0, 0, 1);
	private final Color4f background = new Color4f(.6f, .6f, .6f, 1);
	//=============================================================================================

	//=============================================================================================
	private String font;
	private String text;
	private String icon;
	private String action;
	//=============================================================================================

	//=============================================================================================
	public Widget(GUI gui) {
		this.gui = gui;
		this.gui.widgets.add(this);
	}
	//=============================================================================================

	//=============================================================================================
	public GUI gui() {
		return gui;
	}
	//=============================================================================================
	
	//=============================================================================================
	public String name() {
		return name;
	}
	//=============================================================================================

	//=============================================================================================
	public void name(String name) {
		this.name = name;
		set(Flag.DIRTY);
	}
	//=============================================================================================
	
	//=============================================================================================
	public Set<Flag> flags() {
		return flags_ro;
	}
	//=============================================================================================

	//=============================================================================================
	public boolean match(Flag ... flags) {
		return this.flags.containsAll(List.of(flags));
	}
	//=============================================================================================
	
	//=============================================================================================
	public void set(Flag ... flags) {
		List<Flag> list = List.of(flags);
		this.flags.addAll(list);
		if (parent != null && list.contains(Flag.DISPLAYED)) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================

	//=============================================================================================
	public void clear(Flag ... flags) {
		List<Flag> list = List.of(flags);
		this.flags.removeAll(list);
		if (parent != null && list.contains(Flag.DISPLAYED)) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================
	
	//=============================================================================================
	public Vector2f position() {
		return position;
	}
	//=============================================================================================

	//=============================================================================================
	public void position(Vector2f position) {
		this.position.set(position);
		if (parent != null) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================

	//=============================================================================================
	public void position(float x, float y) {
		this.position.set(x, y);
		if (parent != null) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================
	
	//=============================================================================================
	public Vector2f dimension() {
		return dimension;
	}
	//=============================================================================================

	//=============================================================================================
	public void dimension(Vector2f dimension) {
		this.dimension.set(dimension);
		set(Flag.DIRTY);
		if (parent != null) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================

	//=============================================================================================
	public void dimension(float x, float y) {
		this.dimension.set(x, y);
		set(Flag.DIRTY);
		if (parent != null) {
			parent.set(Flag.DIRTY);
		}
	}
	//=============================================================================================

	//=============================================================================================
	public Color4f foreground() {
		return foreground;
	}
	//=============================================================================================

	//=============================================================================================
	public void foreground(Color4f foreground) {
		this.foreground.set(foreground);
	}
	//=============================================================================================

	//=============================================================================================
	public void foreground(float r, float g, float b, float a) {
		this.foreground.set(r, g, b, a);
	}
	//=============================================================================================

	//=============================================================================================
	public Color4f background() {
		return background;
	}
	//=============================================================================================

	//=============================================================================================
	public void background(Color4f background) {
		this.background.set(background);
	}
	//=============================================================================================

	//=============================================================================================
	public void background(float r, float g, float b, float a) {
		this.background.set(r, g, b, a);
	}
	//=============================================================================================
	
	//=============================================================================================
	public String font() {
		return font;
	}
	//=============================================================================================

	//=============================================================================================
	public void font(String font) {
		this.font = font;
	}
	//=============================================================================================
	
	//=============================================================================================
	public String text() {
		return text;
	}
	//=============================================================================================

	//=============================================================================================
	public void text(String text) {
		this.text = text;
	}
	//=============================================================================================

	//=============================================================================================
	public String icon() {
		return icon;
	}
	//=============================================================================================

	//=============================================================================================
	public void icon(String icon) {
		this.icon = icon;
	}
	//=============================================================================================

	//=============================================================================================
	public String action() {
		return action;
	}
	//=============================================================================================

	//=============================================================================================
	public void action(String action) {
		this.action = action;
	}
	//=============================================================================================
	
	//=============================================================================================
	public void attach(Widget child) {
		super.attach(child);
		set(Flag.DIRTY);
	}
	//=============================================================================================
	
	//=============================================================================================
	public void attach(int idx, Widget child) {
		super.attach(idx, child);
		set(Flag.DIRTY);
	}
	//=============================================================================================

	//=============================================================================================
	public void detach(Widget child) {
		super.detach(child);
		set(Flag.DIRTY);
	}
	//=============================================================================================
	
	//=============================================================================================
	public void toFront() {
		if (parent != null) {
			parent.children.remove(this);
			parent.children.add(this);
			parent.set(Flag.DIRTY);
		} else {
			gui.toFront(this);
		}
	}
	//=============================================================================================
	
}
//*************************************************************************************************
